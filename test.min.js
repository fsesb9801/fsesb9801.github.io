"use strict";let onload=()=>{document.getElementById("add_row").addEventListener("click",(()=>{let n=document.createElement("div");n.classList.add("row");let a=document.createElement("img");a.src="remove.png",a.width="32px",a.height="32px",a.addEventListener("click",t),n.appendChild(a);let r=document.createElement("input");r.type="text",r.classList.add("class_id"),r.addEventListener("change",e),n.appendChild(r);let d=document.createElement("span");d.innerText=" X ",n.appendChild(d);let o=document.createElement("input");o.type="number",o.value=1,o.min="1",o.classList.add("class_mul"),o.addEventListener("change",e),n.appendChild(o),document.getElementById("container").appendChild(n),e()})),document.getElementById("clear_all").addEventListener("click",(()=>{let t=document.getElementsByClassName("row");for(let e=t.length-1;e>=0;e--)t[e].remove();let e=new Event("click");document.getElementById("add_row").dispatchEvent(e)}));let t=t=>{t.target.parentElement.remove(),e()},e=()=>{data=[];let t=document.getElementsByClassName("class_id"),e=document.getElementsByClassName("class_mul");for(let n=0,a=t.length;n<a;n++){let a=t[n].value,r=parseInt(e[n].value);r<1&&(r=1);for(let t=0;t<r;t++)data.push(a)}document.getElementById("chart").children[0].remove(),draw()}};const MAX_ROT=15,MIN_ROT=8;var svg,container,vis,arcs,padding={top:20,right:40,bottom:0,left:0},w=500-padding.left-padding.right,h=500-padding.top-padding.bottom,r=Math.min(w,h)/2,rotation=0,oldrotation=0,picked=1e5,color=d3.scaleOrdinal(d3.schemeSet3),data=[""],pie=d3.pie().sort(null).value((function(t){return 1})),arc=d3.arc().outerRadius(r);let draw=()=>{svg=d3.select("#chart").append("svg").data([data]).attr("width",w+padding.left+padding.right).attr("height",h+padding.top+padding.bottom),container=svg.append("g").attr("class","chartholder").attr("transform","translate("+(w/2+padding.left)+","+(h/2+padding.top)+")"),vis=container.append("g"),(arcs=vis.selectAll("g.slice").data(pie).enter().append("g").attr("class","slice")).append("path").attr("fill",(function(t,e){return color(e)})).attr("d",(function(t){return t.innerRadius=0,t.outerRadius=r,arc(t)})),arcs.append("text").attr("transform",(function(t){return t.innerRadius=0,t.outerRadius=r,t.angle=(t.startAngle+t.endAngle)/2,"rotate("+(180*t.angle/Math.PI-90)+")translate("+(t.outerRadius-10)+")"})).attr("text-anchor","end").text((function(t,e){return data[e]})),svg.append("g").attr("transform","translate("+(w+padding.left+padding.right)+","+(h/2+padding.top)+")").append("path").attr("d","M-"+.15*r+",0L0,"+.05*r+"L0,-"+.05*r+"Z").style("fill","black"),container.append("circle").attr("cx",0).attr("cy",0).attr("r",60).style("cursor","pointer"),container.append("text").attr("x",0).attr("y",15).attr("text-anchor","middle").text("SPIN").attr("style","font-weight:bold; font-size:30px;fill:white;"),container.on("click",spin)};function spin(t){container.on("click",null);var e=360/data.length,n=getRandomNumbers()[Math.floor(10*Math.random())]%(360*Math.abs(7))+2880;rotation=Math.round(n/e)*e,picked=(picked=Math.round(data.length-rotation%360/e))>=data.length?picked%data.length:picked,rotation+=90-Math.round(e/2),vis.transition().duration(3e3).attrTween("transform",rotTween).on("end",(()=>{oldrotation=rotation,document.getElementById("picked").innerText=" "+data[picked],container.on("click",spin)}))}function rotTween(t){var e=d3.interpolate(oldrotation%360,rotation);return function(t){return"rotate("+e(t)+")"}}function getRandomNumbers(){var t=new Uint16Array(10);if(window.hasOwnProperty("crypto")&&"function"==typeof window.crypto.getRandomValues)window.crypto.getRandomValues(t);else for(var e=0;e<10;e++)t[e]=Math.floor(1e5*Math.random())+1;return t}window.addEventListener("DOMContentLoaded",(()=>{draw(),onload();let t=new Event("click");document.getElementById("add_row").dispatchEvent(t)}));